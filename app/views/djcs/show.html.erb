<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Declaración Jurada de Conformidad</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-4">
        <div class="text-end mb-2">
          <p class="mb-0">
            <svg id="Capa_3" data-name="Capa 3" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 71.37 92.93" width="11mm" height="15mm">
              <defs>
                <style>
                  .cls-1 {
                    fill: none;
                    stroke: #000;
                    stroke-miterlimit: 10;
                    stroke-width: .5px;
                  }

                  .cls-2 {
                    fill: #84a3c9;
                  }

                  .cls-4 {
                    font-family: DINPro-Medium, 'DIN Pro';
                    font-size: 3px;
                    font-weight: 500;
                    margin-right: 4px;
                  }

                  .cls-4, .cls-5 {
                    fill: #1f467a;
                  }

                  .cls-6 {
                    fill: #1d1d1b;
                  }
                </style>
              </defs>
              <g id="Capa_1-2" data-name="Capa 1">
                <text class="cls-4" transform="translate(17.03 92.13)"><tspan x="0" y="0">GENERADO POR</tspan></text>
                <g transform="translate(3,0)">
                  <path class="cls-5" d="M45.88,91.35l.48.11c.03-.13.05-.27.05-.41,0-.21-.04-.41-.11-.59l-.43.24c.04.11.06.23.06.35,0,.1-.01.2-.04.3Z"/>
                  <path class="cls-5" d="M45.8,90.56l.43-.23c-.21-.41-.59-.72-1.04-.83l-.05.49h0c.29.09.53.3.66.57Z"/>
                  <g>
                    <path class="cls-5" d="M46.31,91.6l-.48-.11c-.06.14-.15.27-.26.38l.37.33c.17-.16.3-.36.38-.59Z"/>
                    <path class="cls-5" d="M45.86,92.25l-.37-.33s0,0,0,0l-.36-.31.09.47c-.13.05-.26.08-.41.08-.61,0-1.11-.5-1.11-1.11s.5-1.11,1.11-1.11c.07,0,.13,0,.2.02l.04-.49c-.08-.01-.16-.02-.24-.02-.88,0-1.6.72-1.6,1.6s.72,1.6,1.6,1.6c.17,0,.34-.03.5-.08l.07.36.76-.44-.27-.24h0Z"/>
                  </g>
                  <g>
                    <path class="cls-5" d="M48.47,92.33l-.16-.49h-.98l-.17.49h-.56l1.01-2.77h.42l1.01,2.77h-.56ZM47.83,90.38l-.35,1.01h.69l-.34-1.01Z"/>
                    <path class="cls-5" d="M50.71,92.33l-.54-1.1h-.39v1.1h-.54v-2.77h1.08c.56,0,.9.38.9.85,0,.39-.24.63-.51.73l.62,1.19h-.63ZM50.29,90.05h-.51v.73h.51c.24,0,.39-.15.39-.37s-.16-.37-.39-.37Z"/>
                  </g>
                  
                </g>
                <g>
                  <rect class="cls-1" x=".25" y=".25" width="70.87" height="85.04" rx="4.44" ry="4.44"/>
                  <g transform="translate(7.34, 6.17) scale(1.718)">
                    <%= raw djc.qr.generate_svg %>
                  </g>
                  <g>
                    <polygon class="cls-2" points="46.89 70.79 50.17 74.15 58.71 65.61 59.93 66.87 50.21 76.55 45.75 71.88 46.89 70.79"/>
                    <polygon class="cls-2" points="46.89 75.12 50.17 78.48 58.71 69.94 59.93 71.21 50.21 80.88 45.75 76.21 46.89 75.12"/>
                  </g>
                  <g>
                    <path class="cls-6" d="M22.51,77.72h-7.06l-1.34,3.16h-2.46l6.18-14h2.42l6.12,14h-2.52l-1.34-3.16ZM21.61,75.62l-2.64-6.22-2.64,6.22h5.28Z"/>
                    <path class="cls-6" d="M37.11,80.88l-2.56-4.24c-.2.02-.42.02-.64.02h-3.32v4.22h-2.36v-14h5.68c3.58,0,5.64,1.74,5.64,4.78,0,2.24-1.04,3.82-2.9,4.54l3.14,4.68h-2.68ZM33.91,74.54c2.16,0,3.4-.92,3.4-2.82s-1.24-2.72-3.4-2.72h-3.32v5.54h3.32Z"/>
                  </g>
                </g>
              </g>
            </svg>
          </p>
          <span class="text-muted" style="font-size: 0.6rem;"><%= djc.qr.url %></span>
        </div>

        <h3 class="text-center">DECLARACIÓN JURADA DE CONFORMIDAD <%= "#{djc.qr.code}-#{djc.id}".upcase%></h1>
        <h5 class="text-center"><%= djc.reglamento_tecnico.nombre %></h3>

        <p class="mt-4">Nosotros</p>
        <p>Razón Social: <strong><%= djc.company.name %></strong></p>
        <p>CUIT: <strong><%= djc.company.cuit %></strong></p>
        <p>Nombre comercial o Marca registrada: <strong><%= djc.trade_mark %></strong></p>
        <p>Dirección: <strong><%= djc.company.address %></strong></p>
        <p>Dirección de fábrica o depósito en Argentina: <strong><%= djc.deposit_address %></strong></p>
        <p>Origen: <strong><%= djc.origin %></strong></p>
        <p>Teléfono: <strong><%= djc.company.contact_phone %></strong></p>
        <p>Mail: <strong><%= djc.company.contact_email %></strong></p>

        <p class="mt-4">Emitimos la presente declaración de conformidad con relación a los siguientes productos:</p>
        <p>Descripción: <strong><%= djc.product_description %></strong></p>
        <p>Fabricante: <strong><%= djc.manufacturer %></strong></p>
        <p>Domicilio: <strong><%= djc.manufacturer_address %></strong></p>

        <p class="mt-4">Productos:</p>
        <table class="table table-striped table-bordered table-hover align-middle">
          <thead class="table-dark">
            <tr>
              <th>Marca</th>
              <th>Modelo</th>
              <th>Características técnicas</th>
            </tr>
          </thead>
          <tbody>
            <% djc.product_attributes.each do |p| %>
              <tr>
                <td><%= p["brand"] %></td>
                <td><%= p["model"] %></td>
                <td><%= p["characteristic"] %></td>
              </tr>
            <% end %>
          </tbody>
        </table>

        <p>Estos productos alcanzados por el siguiente reglamento técnico:</p>
        <p><strong><%= djc.reglamento_tecnico.nombre %></strong></p>

        <p class="mt-4">Cumplen con las siguientes normas técnicas:</p>
        <table class="table table-striped table-bordered table-hover align-middle">
          <thead class="table-dark">
            <tr>
              <th>Norma Técnica</th>
            </tr>
          </thead>
          <tbody>
            <% djc.technical_normatives.each do |t| %>
              <tr>
                <td><%= t %></td>
              </tr>
            <% end %>
          </tbody>
        </table>

        <p class="mt-4">Habiendo sido sometidos al siguiente procedimiento de evaluación de la conformidad:</p>
        <p><strong><%= djc.tipo_procedimiento.nombre %></strong></p>
        <table class="table table-striped table-bordered table-hover align-middle">
          <thead class="table-dark">
            <tr>
              <th>Número de Reporte</th>
              <th>Emisor</th>
            </tr>
          </thead>
          <tbody>
            <% djc.reports.each do |r| %>
              <tr>
                <td><%= r["number"] %></td>
                <td><%= r["emitter"] %></td>
              </tr>
            <% end %>
          </tbody>
        </table>

        <p class="mt-4"><strong><%= djc.company.name %></strong></p>
        <p><%= djc.company.address %>, <%= djc.created_at.strftime("%A %d de %B de %Y") %></p>

        <p class="mt-4">La presente declaración jurada de conformidad se emite, en todo de acuerdo con el/los Reglamentos Técnicos aludidos precedentemente, asumiendo la responsabilidad directa por los datos declarados, así como por la conformidad del producto.</p>

        <% if djc.signed_by.present? %>
          <% signature = Base64.encode64(djc.signed_by.signature_file.download) %>
          <div class="text-end mt-5">
              <img src="data:<%= djc.signed_by.signature_file.content_type %>;base64,<%= signature %>" alt="Signature" width="120"/>
              <p><strong><%= djc.signed_by.name %></strong></p>
              <p><strong><%= djc.signed_by.position %></strong></p>
              <p><strong><%= djc.company.name %></strong></p>
          </div>
        <% end %>

        <footer class="mt-5">
            <p><small>
              Generado por: <strong><%= djc.creator.name %></strong> - 
              Aprobado por: <strong><%= djc.approved_by.try(:name) %></strong>
            </small></p>
        </footer>
    </div>
</body>
</html>
